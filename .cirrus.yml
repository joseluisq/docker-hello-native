task:
  only_if: $CIRRUS_TAG == ''
  timeout_in: 120m
  alias: build-linux-image
  matrix:
    - name: linux-amd64
      compute_engine_instance:
        image_project: cirrus-images
        image: family/docker-builder
        platform: linux
        cpu: 8
        memory: 8G

    - name: linux-arm64
      compute_engine_instance:
        image_project: cirrus-images
        image: family/docker-builder-arm64
        architecture: arm64
        platform: linux
        cpu: 4
        memory: 4G

  build_script: make docker-build
  run_script: make docker-run
